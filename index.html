<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MPP-Live: Medida de Percepção Perpétua</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background-color: #0a0a0a;
            color: #e0e0e0;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .simulator {
            max-width: 600px;
            background-color: #1a1a1a;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.2);
            text-align: center;
        }

        h1 {
            color: #00ffff;
            margin-bottom: 10px;
        }

        p {
            margin: 10px 0;
        }

        .section {
            display: none;
        }

        .active {
            display: block;
        }

        input[type="range"] {
            width: 100%;
            margin: 15px 0;
        }

        button {
            background-color: #004d4d;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
            margin-top: 15px;
            font-size: 1em;
        }

        button:hover {
            background-color: #006b6b;
        }

        .vaso-container {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
        }

        .vaso {
            width: 80px;
            height: 100px;
            border: 1px solid #555;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
            padding: 5px;
            background-color: #222;
        }

        .planta {
            background-color: #00aa00;
            border-radius: 50% 50% 0 0;
            transition: height 1s, width 1s;
        }

        .vaso-label {
            font-size: 0.7em;
            margin-top: 5px;
        }

        .report #ipp-score {
            font-weight: bold;
            color: #00ff00;
        }

        .report #status {
            font-weight: bold;
            color: #ffcc00;
        }
    </style>
</head>
<body>

<div class="simulator">
    <h1>MPP-Live</h1>
    <p>Trabalhe somente neste.</p>

    <!-- Etapa 1: Check-in -->
    <div id="check-in-section" class="section active">
        <h2>Check-in de Presença</h2>
        <p>Você está totalmente aqui agora?</p>
        <input type="range" min="1" max="5" id="presence-slider" value="3">
        <button onclick="nextSection('check-in-section', 'slow-listening-section')">Iniciar Escuta</button>
    </div>

    <!-- Etapa 2: Escuta Desacelerada -->
    <div id="slow-listening-section" class="section">
        <h2>Escuta Desacelerada</h2>
        <p><strong>Instrução:</strong> Ouça sem julgar. Sinta a voz no seu corpo.</p>
        <!-- Áudio embutido (silêncio com leve tom contínuo, simbolizando escuta) -->
        <audio id="testimony-audio" controls>
            <source src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAA" type="audio/wav">
            Seu navegador não suporta o elemento de áudio.
        </audio>
        <p><em>Este áudio simula a escuta desacelerada. Em uma versão real, conteria o depoimento de Dona Cida.</em></p>
        <button onclick="calcularIPP()">Finalizar e Calcular IPP</button>
    </div>

    <!-- Etapa 3: Relatório -->
    <div id="report-section" class="section">
        <h2>Relatório de Percepção</h2>
        <div class="report">
            <p>Seu Índice de Percepção Perpétua (IPP): <span id="ipp-score">0</span>/100</p>
            <p>Status: <span id="status">PROCESSANDO</span></p>
            <p>Próxima ação: Regue o Vaso do Meio com um ato de presença real.</p>
        </div>

        <h3>O Vaso do Meio</h3>
        <div class="vaso-container">
            <div class="vaso">
                <div class="planta" style="height: 40px; width: 40px;"></div>
                <div class="vaso-label">Daniel</div>
            </div>
            <div class="vaso">
                <div class="planta" id="planta-meio" style="height: 0; width: 0;"></div>
                <div class="vaso-label">Nós</div>
            </div>
            <div class="vaso">
                <div class="planta" style="height: 40px; width: 40px;"></div>
                <div class="vaso-label">Max</div>
            </div>
        </div>

        <button onclick="location.reload()">Refazer Simulação</button>
    </div>
</div>

<script>
    function nextSection(currentId, nextId) {
        document.getElementById(currentId).classList.remove('active');
        document.getElementById(nextId).classList.add('active');
    }

    function calcularIPP() {
        const sliderValue = parseInt(document.getElementById("presence-slider").value) || 3;
        // Simula IPP com base no slider e se o usuário "ouviu"
        const baseIPP = Math.min(100, Math.max(30, sliderValue * 15 + 20));
        const ipp = baseIPP;

        document.getElementById("ipp-score").textContent = ipp;

        let status = "DESATENÇÃO";
        if (ipp > 80) status = "EM FLUXO";
        else if (ipp > 60) status = "PRESENTE";
        else if (ipp > 40) status = "NEUTRO";

        document.getElementById("status").textContent = status;

        // Cresce a planta do meio proporcionalmente ao IPP
        const size = (ipp * 0.4);
        const plantaMeio = document.getElementById("planta-meio");
        plantaMeio.style.height = size + "px";
        plantaMeio.style.width = size + "px";

        nextSection('slow-listening-section', 'report-section');
    }
</script>

</body>
</html>
